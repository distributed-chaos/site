<!DOCTYPE html>
<html>
<head>
    <title>Calendar Test</title>
    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.css' rel='stylesheet' />
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        #calendar { margin-top: 20px; }
        .debug { background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>Calendar Debug Test</h1>
    
    <div class="debug">
        <h3>Debug Info:</h3>
        <div id="debug-info">Loading...</div>
    </div>
    
    <div id="calendar"></div>

    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js'></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var calendarEl = document.getElementById('calendar');
            var debugEl = document.getElementById('debug-info');
            
            debugEl.innerHTML = 'Starting calendar initialization...';
            
            // Test fetch to events.json
            fetch('/_data/events.json')
                .then(response => {
                    debugEl.innerHTML += '<br>Response status: ' + response.status;
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => {
                    debugEl.innerHTML += '<br>Data loaded successfully';
                    debugEl.innerHTML += '<br>Recurring events: ' + (data.recurring_events ? data.recurring_events.length : 0);
                    debugEl.innerHTML += '<br>One-time events: ' + (data.one_time_events ? data.one_time_events.length : 0);
                    debugEl.innerHTML += '<br>Categories: ' + (data.categories ? data.categories.length : 0);
                    
                    // Simple test events
                    var testEvents = [
                        {
                            title: 'Test Event 1',
                            start: '2024-06-15T10:00:00',
                            backgroundColor: '#ff6b6b'
                        },
                        {
                            title: 'Test Event 2', 
                            start: '2024-06-20T14:00:00',
                            backgroundColor: '#4ecdc4'
                        }
                    ];
                    
                    debugEl.innerHTML += '<br>Initializing calendar with test events...';
                    
                    var calendar = new FullCalendar.Calendar(calendarEl, {
                        initialView: 'dayGridMonth',
                        events: testEvents,
                        eventClick: function(info) {
                            alert('Event: ' + info.event.title);
                        }
                    });
                    
                    calendar.render();
                    debugEl.innerHTML += '<br>Calendar rendered successfully!';
                })
                .catch(error => {
                    debugEl.innerHTML += '<br><span style="color: red;">Error: ' + error.message + '</span>';
                    console.error('Error:', error);
                });
        });
    </script>
</body>
</html>